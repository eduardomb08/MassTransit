<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Initializing interface message contracts | MassTransit</title>
    <meta name="description" content="A free, open-source distributed application framework for .NET.">
    
    
    <link rel="preload" href="/MassTransit/assets/css/0.styles.3c3540eb.css" as="style"><link rel="preload" href="/MassTransit/assets/js/app.35715e6f.js" as="script"><link rel="preload" href="/MassTransit/assets/js/2.d01194ec.js" as="script"><link rel="preload" href="/MassTransit/assets/js/88.93d28381.js" as="script"><link rel="prefetch" href="/MassTransit/assets/js/10.4c8ec4ee.js"><link rel="prefetch" href="/MassTransit/assets/js/100.a4922aba.js"><link rel="prefetch" href="/MassTransit/assets/js/101.28301740.js"><link rel="prefetch" href="/MassTransit/assets/js/102.4da7841b.js"><link rel="prefetch" href="/MassTransit/assets/js/103.55327799.js"><link rel="prefetch" href="/MassTransit/assets/js/104.c327e2ce.js"><link rel="prefetch" href="/MassTransit/assets/js/105.03546a12.js"><link rel="prefetch" href="/MassTransit/assets/js/106.fca1c0dc.js"><link rel="prefetch" href="/MassTransit/assets/js/11.ae22c166.js"><link rel="prefetch" href="/MassTransit/assets/js/12.697658b9.js"><link rel="prefetch" href="/MassTransit/assets/js/13.7b86bb52.js"><link rel="prefetch" href="/MassTransit/assets/js/14.be5c99d8.js"><link rel="prefetch" href="/MassTransit/assets/js/15.d0f537bf.js"><link rel="prefetch" href="/MassTransit/assets/js/16.cbfcd2ad.js"><link rel="prefetch" href="/MassTransit/assets/js/17.0c1291de.js"><link rel="prefetch" href="/MassTransit/assets/js/18.3a0ff71b.js"><link rel="prefetch" href="/MassTransit/assets/js/19.5c3468d1.js"><link rel="prefetch" href="/MassTransit/assets/js/20.00f55e73.js"><link rel="prefetch" href="/MassTransit/assets/js/21.0e5ecf82.js"><link rel="prefetch" href="/MassTransit/assets/js/22.e77c30a0.js"><link rel="prefetch" href="/MassTransit/assets/js/23.2ccaddf7.js"><link rel="prefetch" href="/MassTransit/assets/js/24.e5122a93.js"><link rel="prefetch" href="/MassTransit/assets/js/25.ff9934c4.js"><link rel="prefetch" href="/MassTransit/assets/js/26.c96a8535.js"><link rel="prefetch" href="/MassTransit/assets/js/27.42f0b0e8.js"><link rel="prefetch" href="/MassTransit/assets/js/28.b139b450.js"><link rel="prefetch" href="/MassTransit/assets/js/29.44427ee4.js"><link rel="prefetch" href="/MassTransit/assets/js/3.0af1cfd3.js"><link rel="prefetch" href="/MassTransit/assets/js/30.a3c7546f.js"><link rel="prefetch" href="/MassTransit/assets/js/31.26d3b153.js"><link rel="prefetch" href="/MassTransit/assets/js/32.21c8d85c.js"><link rel="prefetch" href="/MassTransit/assets/js/33.60e822ec.js"><link rel="prefetch" href="/MassTransit/assets/js/34.83670677.js"><link rel="prefetch" href="/MassTransit/assets/js/35.7121ef0d.js"><link rel="prefetch" href="/MassTransit/assets/js/36.b3bdb7a7.js"><link rel="prefetch" href="/MassTransit/assets/js/37.fd50b8c6.js"><link rel="prefetch" href="/MassTransit/assets/js/38.ca1af769.js"><link rel="prefetch" href="/MassTransit/assets/js/39.8a01e6c2.js"><link rel="prefetch" href="/MassTransit/assets/js/4.59116900.js"><link rel="prefetch" href="/MassTransit/assets/js/40.d28c9f0a.js"><link rel="prefetch" href="/MassTransit/assets/js/41.98667d2f.js"><link rel="prefetch" href="/MassTransit/assets/js/42.f39f09a4.js"><link rel="prefetch" href="/MassTransit/assets/js/43.1e05245e.js"><link rel="prefetch" href="/MassTransit/assets/js/44.4e17f750.js"><link rel="prefetch" href="/MassTransit/assets/js/45.8d1d7271.js"><link rel="prefetch" href="/MassTransit/assets/js/46.b2dbac86.js"><link rel="prefetch" href="/MassTransit/assets/js/47.f1aa8bbb.js"><link rel="prefetch" href="/MassTransit/assets/js/48.44c78fa3.js"><link rel="prefetch" href="/MassTransit/assets/js/49.083d197d.js"><link rel="prefetch" href="/MassTransit/assets/js/5.1d3e2cf6.js"><link rel="prefetch" href="/MassTransit/assets/js/50.acdb5188.js"><link rel="prefetch" href="/MassTransit/assets/js/51.368b1bb1.js"><link rel="prefetch" href="/MassTransit/assets/js/52.a16ac88f.js"><link rel="prefetch" href="/MassTransit/assets/js/53.747838c5.js"><link rel="prefetch" href="/MassTransit/assets/js/54.88a4e8f0.js"><link rel="prefetch" href="/MassTransit/assets/js/55.1ed74524.js"><link rel="prefetch" href="/MassTransit/assets/js/56.d6be0941.js"><link rel="prefetch" href="/MassTransit/assets/js/57.ec053e4a.js"><link rel="prefetch" href="/MassTransit/assets/js/58.89897b01.js"><link rel="prefetch" href="/MassTransit/assets/js/59.b03c9a56.js"><link rel="prefetch" href="/MassTransit/assets/js/6.7d02cd3b.js"><link rel="prefetch" href="/MassTransit/assets/js/60.6f5c5a8e.js"><link rel="prefetch" href="/MassTransit/assets/js/61.22b788f0.js"><link rel="prefetch" href="/MassTransit/assets/js/62.7a46067b.js"><link rel="prefetch" href="/MassTransit/assets/js/63.fa629e14.js"><link rel="prefetch" href="/MassTransit/assets/js/64.461d2327.js"><link rel="prefetch" href="/MassTransit/assets/js/65.3be2b22c.js"><link rel="prefetch" href="/MassTransit/assets/js/66.088eaa99.js"><link rel="prefetch" href="/MassTransit/assets/js/67.aa4a0e42.js"><link rel="prefetch" href="/MassTransit/assets/js/68.2343f41a.js"><link rel="prefetch" href="/MassTransit/assets/js/69.5760c371.js"><link rel="prefetch" href="/MassTransit/assets/js/7.d34c132d.js"><link rel="prefetch" href="/MassTransit/assets/js/70.1b795a08.js"><link rel="prefetch" href="/MassTransit/assets/js/71.5f851dc4.js"><link rel="prefetch" href="/MassTransit/assets/js/72.4e7b6ada.js"><link rel="prefetch" href="/MassTransit/assets/js/73.0c270da4.js"><link rel="prefetch" href="/MassTransit/assets/js/74.ed350914.js"><link rel="prefetch" href="/MassTransit/assets/js/75.96bac087.js"><link rel="prefetch" href="/MassTransit/assets/js/76.8164340d.js"><link rel="prefetch" href="/MassTransit/assets/js/77.be02c6e3.js"><link rel="prefetch" href="/MassTransit/assets/js/78.1af2718f.js"><link rel="prefetch" href="/MassTransit/assets/js/79.4a5eab4b.js"><link rel="prefetch" href="/MassTransit/assets/js/8.3bb286ea.js"><link rel="prefetch" href="/MassTransit/assets/js/80.2f525084.js"><link rel="prefetch" href="/MassTransit/assets/js/81.20e04321.js"><link rel="prefetch" href="/MassTransit/assets/js/82.eb5a0b20.js"><link rel="prefetch" href="/MassTransit/assets/js/83.899fe852.js"><link rel="prefetch" href="/MassTransit/assets/js/84.7fb595a1.js"><link rel="prefetch" href="/MassTransit/assets/js/85.05972788.js"><link rel="prefetch" href="/MassTransit/assets/js/86.c4fdf3b1.js"><link rel="prefetch" href="/MassTransit/assets/js/87.7caa98a0.js"><link rel="prefetch" href="/MassTransit/assets/js/89.cca0c0da.js"><link rel="prefetch" href="/MassTransit/assets/js/9.e44e6573.js"><link rel="prefetch" href="/MassTransit/assets/js/90.a5271be3.js"><link rel="prefetch" href="/MassTransit/assets/js/91.7c2ab6d7.js"><link rel="prefetch" href="/MassTransit/assets/js/92.e7602d7b.js"><link rel="prefetch" href="/MassTransit/assets/js/93.7085c7ed.js"><link rel="prefetch" href="/MassTransit/assets/js/94.80cdb40c.js"><link rel="prefetch" href="/MassTransit/assets/js/95.2f02370f.js"><link rel="prefetch" href="/MassTransit/assets/js/96.435c4c8b.js"><link rel="prefetch" href="/MassTransit/assets/js/97.b9149593.js"><link rel="prefetch" href="/MassTransit/assets/js/98.27982cf5.js"><link rel="prefetch" href="/MassTransit/assets/js/99.2b4ae788.js">
    <link rel="stylesheet" href="/MassTransit/assets/css/0.styles.3c3540eb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/MassTransit/" class="home-link router-link-active"><img src="/MassTransit/mt-logo-small.png" alt="MassTransit" class="logo"> <span class="site-name can-hide">MassTransit</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://gitter.im/MassTransit/MassTransit" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://nuget.org/packages/MassTransit" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NuGet
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/MassTransit/MassTransit" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://gitter.im/MassTransit/MassTransit" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://nuget.org/packages/MassTransit" target="_blank" rel="noopener noreferrer" class="nav-link external">
  NuGet
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/MassTransit/MassTransit" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/MassTransit/getting-started/" class="sidebar-heading clickable open"><span>Getting Started</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/MassTransit/getting-started/upgrade-v6.html" class="sidebar-link">Upgrading</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/MassTransit/usage/" class="sidebar-heading clickable router-link-active"><span>Using MassTransit</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/MassTransit/usage/configuration.html" class="sidebar-link">Configuration</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/MassTransit/usage/transports/" class="sidebar-heading clickable"><span>Transports</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/MassTransit/usage/messages.html" class="sidebar-link">Messages</a></li><li><a href="/MassTransit/usage/consumers.html" class="sidebar-link">Consumers</a></li><li><a href="/MassTransit/usage/producers.html" class="sidebar-link">Producers</a></li><li><a href="/MassTransit/usage/exceptions.html" class="sidebar-link">Exceptions</a></li><li><a href="/MassTransit/usage/requests.html" class="sidebar-link">Requests</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/MassTransit/usage/sagas/" class="sidebar-heading clickable"><span>Sagas</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/MassTransit/usage/containers/" class="sidebar-heading clickable"><span>Containers</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/MassTransit/usage/testing.html" class="sidebar-link">Testing</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Advanced</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/MassTransit/learn/" class="sidebar-heading clickable"><span>Getting Help</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Reference</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="initializing-interface-message-contracts"><a href="#initializing-interface-message-contracts" class="header-anchor">#</a> Initializing interface message contracts</h1> <p>MassTransit continues to encourage and support the use of interfaces for message contracts, and initializers make it easy to produce interface messages.</p> <h2 id="an-object-of-values"><a href="#an-object-of-values" class="header-anchor">#</a> An object of values</h2> <p><code>Send</code>, <code>Publish</code>, and most of the methods that behave in similar ways (scheduling, responding to requests, etc.) all support passing an object of <em>values</em> which is used to set the properties on the specified interface. A simple example is shown below.</p> <p>Consider this example message contract to submit an order.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SubmitOrder</span>
<span class="token punctuation">{</span>
    <span class="token class-name">Guid</span> OrderId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token class-name">DateTime</span> OrderDate <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">string</span> OrderNumber <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">decimal</span> OrderAmount <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>To send this message to an endpoint:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">await</span> endpoint<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Send</span><span class="token punctuation">&lt;</span><span class="token class-name">SubmitOrder</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span>
<span class="token punctuation">{</span>
    OrderId <span class="token operator">=</span> NewId<span class="token punctuation">.</span><span class="token function">NextGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    OrderDate <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>UtcNow<span class="token punctuation">,</span>
    OrderNumber <span class="token operator">=</span> <span class="token string">&quot;18001&quot;</span><span class="token punctuation">,</span>
    OrderAmount <span class="token operator">=</span> <span class="token number">123.45</span>m
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The anonymous object is loosely typed, the properties are matched by name, and there is an extensive set of type conversions that may occur to obtain match the types defined by the interface. Most numeric, string, and date/time conversations are supported, as well as several advanced conversions (including variables, and asynchronous <code>Task&lt;T&gt;</code> results).</p> <p>Collections, including arrays, lists, and dictionaries, are broadly supported, including the conversion of list elements, as well as dictionary keys and values. For instance, a dictionary of (int,decimal) could be converted on the fly to (long, string) using the default format conversions.</p> <p>Nested objects are also supported, for instance, if a property was of type <code>Address</code> and another anonymous object was created (or any type whose property names match the names of the properties on the message contract), those properties would be set on the message contract.</p> <h2 id="headers"><a href="#headers" class="header-anchor">#</a> Headers</h2> <p>Header values can be specified in the anonymous object using a double-underscore (pronounced 'dunder' apparently) property name. For instance, to set the message time-to-live, specify a property with the duration. Remember, any value that can be converted to a <code>TimeSpan</code> works!</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">GetOrderStatus</span>
<span class="token punctuation">{</span>
    <span class="token class-name">Guid</span> OrderId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token keyword">await</span> requestClient<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetResponse</span><span class="token punctuation">&lt;</span><span class="token class-name">OrderStatus</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> 
<span class="token punctuation">{</span>
    __TimeToLive <span class="token operator">=</span> <span class="token number">15000</span><span class="token punctuation">,</span> <span class="token comment">// 15 seconds, or in this case, 15000 milliseconds</span>
    OrderId <span class="token operator">=</span> orderId<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>actually, that's a bad example since the request client already sets the message expiration, but you, get, the, point.</p></blockquote> <p>To add a custom header value, a special property name format is used. In the name, underscores are converted to dashes, and double underscores are converted to underscores. In the following example:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token keyword">await</span> requestClient<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetResponse</span><span class="token punctuation">&lt;</span><span class="token class-name">OrderStatus</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> 
<span class="token punctuation">{</span>
    __Header_X_B3_TraceId <span class="token operator">=</span> zipkinTraceId<span class="token punctuation">,</span>
    __Header_X_B3_SpanId <span class="token operator">=</span> zipkinSpanId<span class="token punctuation">,</span>
    OrderId <span class="token operator">=</span> orderId<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This would include set the headers used by open tracing (or Zipkin, as shown above) as part of the request message so the service could share in the span/trace. In this case, <code>X-B3-TraceId</code> and <code>X-B3-SpanId</code> would be added to the message envelope, and depending upon the transport, copied to the transport headers as well.</p> <h2 id="variables"><a href="#variables" class="header-anchor">#</a> Variables</h2> <p>MassTransit also supports variables, which are special types added to the anonymous object. Following the example above, the initialization could be changed to use variables for the <code>OrderId</code> and <code>OrderDate</code>. Variables are consistent throughout the message creation, using the same variable multiple times returns the value. For instance, the Id created to set the <em>OrderId</em> would be the same used to set the <em>OrderId</em> in each item.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderItem</span>
<span class="token punctuation">{</span>
    <span class="token class-name">Guid</span> OrderId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">string</span> ItemNumber <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SubmitOrder</span>
<span class="token punctuation">{</span>
    <span class="token class-name">Guid</span> OrderId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token class-name">DateTime</span> OrderDate <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">string</span> OrderNumber <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">decimal</span> OrderAmount <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    OrderItem<span class="token punctuation">[</span><span class="token punctuation">]</span> OrderItems <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">await</span> endpoint<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Send</span><span class="token punctuation">&lt;</span><span class="token class-name">SubmitOrder</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span>
<span class="token punctuation">{</span>
    OrderId <span class="token operator">=</span> InVar<span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
    OrderDate <span class="token operator">=</span> InVar<span class="token punctuation">.</span>Timestamp<span class="token punctuation">,</span>
    OrderNumber <span class="token operator">=</span> <span class="token string">&quot;18001&quot;</span><span class="token punctuation">,</span>
    OrderAmount <span class="token operator">=</span> <span class="token number">123.45</span>m<span class="token punctuation">,</span>
    OrderItems <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token punctuation">{</span> OrderId <span class="token operator">=</span> InVar<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> ItemNumber <span class="token operator">=</span> <span class="token string">&quot;237&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token punctuation">{</span> OrderId <span class="token operator">=</span> InVar<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> ItemNumber <span class="token operator">=</span> <span class="token string">&quot;762&quot;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="awaiting-task-results"><a href="#awaiting-task-results" class="header-anchor">#</a> Awaiting Task results</h2> <p>Message initializers are now asynchronous, which makes it possible to do some pretty cool things, including waiting for Task input properties to complete and use the result to initialize the property. An example is shown below.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderUpdated</span>
<span class="token punctuation">{</span>
    <span class="token class-name">Guid</span> CorrelationId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token class-name">DateTime</span> Timestamp <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token class-name">Guid</span> OrderId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token class-name">Customer</span> Customer <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>CustomerInfo<span class="token operator">&gt;</span> <span class="token function">LoadCustomer</span><span class="token punctuation">(</span><span class="token class-name">Guid</span> orderId<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// work happens up in here</span>
<span class="token punctuation">}</span>

<span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Publish</span><span class="token punctuation">&lt;</span><span class="token class-name">OrderUpdated</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span>
<span class="token punctuation">{</span>
    InVar<span class="token punctuation">.</span>CorrelationId<span class="token punctuation">,</span>
    InVar<span class="token punctuation">.</span>Timestamp<span class="token punctuation">,</span>
    OrderId <span class="token operator">=</span> context<span class="token punctuation">.</span>Message<span class="token punctuation">.</span>OrderId<span class="token punctuation">,</span>
    Customer <span class="token operator">=</span> <span class="token function">LoadCustomer</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>Message<span class="token punctuation">.</span>OrderId<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The property initializer will wait for the task result and then use it to initialize the property (converting all the types, etc. as it would any other object).</p> <blockquote><p>While it is of course possible to await the call to <code>LoadCustomer</code>, properties are initialized in parallel, and thus, allowing the initializer to await the Task can result in better overall performance. Your mileage may vary, however.</p></blockquote></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/MassTransit/MassTransit/edit/develop/docs/usage/message-initializers.md" target="_blank" rel="noopener noreferrer">Help us by improving this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/5/2019, 2:31:07 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/MassTransit/assets/js/app.35715e6f.js" defer></script><script src="/MassTransit/assets/js/2.d01194ec.js" defer></script><script src="/MassTransit/assets/js/88.93d28381.js" defer></script>
  </body>
</html>
